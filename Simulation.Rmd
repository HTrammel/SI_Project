---
title: "A Comparison of Expoential Distribution in R and the Central Limit Theorem"
author: "Harold Trammel"
date: "August 11, 2015"
output: html_document
---

```{r loadLibraries}
library(ggplot2)
library(MASS)

theo_mean <- 1/0.2
theo_sd <- 1/0.2
theo_var <- theo_sd^2

```
### Overview

The purpose of this project is to nvestigate the exponential distribution in R and compare it with the Central Limit Theorem. The exponential distribution can be simulated in R with rexp(n, lambda) where lambda is the rate parameter. The mean of exponential distribution is 1/lambda and the standard deviation is also 1/lambda. Set lambda = 0.2 for all of the simulations. You will investigate the distribution of averages of 40 exponentials. Note that you will need to do a thousand simulations.  Illustrate via simulation and associated explanatory text the properties of the distribution of the mean of 40 exponentials.

### Simulations
In order to make the needed comparisons, two sets of simulations were performed.  The first set ran a thousand simulations of exponential distributions with a rate parameter or lambda of 0.2.  The mean and standard deviation for this collection of simulations were calculated and compared to the theoretical values for exponential distributions. 

The theoretical mean was 1/lambda or 1/0.2 = 5.  The heoretical standard deviation was also 1/lambda or 1/0.2 = 5.  This in turn yielded the theoretical variance of 25 (the theoretical standard deviation squared).

The following code was used for this full simulation.

```{r basic_simulation}
num_sim <- 1000
num_samp <- 40

```

A sample of this generated data is depicted in the following graph. 

```{r plot_sample}
set.seed(4)
samp <- data.frame(rexp(num_sim, 0.2))
names(samp) <- "x"
samp_fit <- fitdistr(samp$x, "exponential")
samp_rate <- samp_fit$estimate[1]

diff_rate <- round(abs(0.2 - samp_rate), 3)

g1 <- ggplot(samp, aes(x = x)) +
    geom_histogram(alpha = .20, binwidth=.3, colour = "black", aes(y = ..density..)) +
    ggtitle("Sample of Expoential Distribution") +
    stat_function(fun = dexp,
            args = list(rate = samp_rate),
            size = 2)
print(g1)
```

A best fit estimate of the sample's rate overlays the histogram.  The estimated rate for this sample was `r round(samp_rate, 3)` or `r round(abs(0.2 - samp_rate), 3)` difference from predetermined rate.

The actual means of the data from the simulation were determined and were subsequently plotted.  

```{r plot_simulation_means}
set.seed(4)
dat <- data.frame(replicate(num_sim, rexp(num_samp, 0.2)))
mn_df <- data.frame(colMeans(dat))
names(mn_df) <- "x"

mn_fit <- fitdistr(mn_df$x, "normal")
est_mean <- mn_fit$estimate[1]
est_sd <- mn_fit$estimate[2]

g2 <- ggplot(mn_df, aes(x)) +
    geom_histogram(alpha = .20, binwidth=.3, colour = "black", aes(y = ..density..)) +
    geom_vline(stat = "vline", xintercept = theo_mean,
               size = 2, color = "red", linetype = 1, show_guide = T) +
    ggtitle("Plot of Means from Simulated Exponential Distribution") +
    stat_function(fun = dnorm,
                args = list(mean = est_mean, sd = est_sd),
                size = 2)
print(g2)

```

The graph suggested a normal distribution so a best fit estimate was made and this was plotted as an overlay. The estimated mean of this distribution was `r round(est_mean, 3)` or a `r round(abs(5 - est_mean), 3)` difference from the theoretical mean.  The estimated standard distribution of `r round(est_sd, 3)`, or a `r round(abs(0.5 - est_sd), 3)` difference from the theoretical standard deviation.


The second simulation looked at the distribution of averages of 40 exponentials sampled from a thousand simulations. The following code was used for this sampled simulation.

```{r}

# CLT formula for Exponential Distribution
clt_func <- function(x, n) (mean(x) - 0.5 / (5 / sqrt(n)))
set.seed(40)
idx <- sample(1:nrow(mn_df), 40)
clt_dat <- mn_df[idx,]
clt_df = NULL
for (i in clt_dat) clt_df <- rbind(clt_df, (clt_func(i,40)))

clt_df <- data.frame(clt_df)
names(clt_df) <- "x"


clt_fit <- fitdistr(clt_df$x, "normal")

g3 <- ggplot(clt_df, aes(x = x)) +
    geom_histogram(alpha = .20, binwidth=.3, colour = "black", aes(y = ..density..)) +
    geom_vline(stat = "vline", xintercept = theo_mean,
               size = 2, color = "red", linetype = 1, show_guide = T) +
    ggtitle("Plot of 40 Sample Means from Simulated Exponential Distribution") +
    stat_function(fun = dnorm,
                  args = list(mean = clt_fit$estimate[1], sd = clt_fit$estimate[2]),
                  size = 2)
print(g3)
```

### Sample Mean versus Theoretical Mean
1. Show the sample mean and compare it to the theoretical mean of the distribution.
Include figures with titles. In the figures, highlight the means you are comparing. Include text that explains the figures and what is shown on them, and provides appropriate numbers.

### Sample Variance versus Theoretical Variance
2. Show how variable the sample is (via variance) and compare it to the theoretical variance of the distribution.
Include figures (output from R) with titles. Highlight the variances you are comparing. Include text that explains your understanding of the differences of the variances.

### Distribution
3. Show that the distribution is approximately normal.
In point 3, focus on the difference between the distribution of a large collection of random exponentials and the distribution of a large collection of averages of 40 exponentials. 
Via figures and text, explain how one can tell the distribution is approximately normal.

> Evaluation

> 1. Regarding the distribution of the mean of 40 exponentials. Did the student show where the distribution is centered at and compare it  to the theoretical center of the distribution?

> 2. Regarding the distribution of the mean of 40 exponentials. Did the student show how variable it is and compare it to the theoretical variance of the distribution?

> 3. Was the report a pdf report of the required length?

> 4. Here's your opportunity to give this project +1 for effort. Did the student basically try to answer the question?



